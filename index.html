<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shifat Shahriar Siam - Public Health & Beyond</title>
    <!-- GLOBAL GOOGLE ADSENSE CODE - Your specific client ID integrated -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6894065582382364"
     crossorigin="anonymous"></script>
    <!-- END GLOBAL GOOGLE ADSENSE CODE -->

    <!-- Load Tailwind CSS from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter font from Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for Social Icons (Required for new footer icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" xintegrity="sha512-1ycn6IcaQQ40jBq0UjlwtYJmZtfWwW52X2+UuJ+u8V0t10XqL9U2FjD1eU9p5K0fK1u0q50a6y0+o/6P+g==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        /* Apply Inter font globally and set a base text color */
        body {
            font-family: 'Inter', sans-serif;
            color: #333; /* Dark gray for good readability */
            background-color: #f9fafb; /* Light gray background */
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Custom styles for Hero Section Background Pattern */
        .hero-stars-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden; /* Crucial to contain stars within the hero section */
            background: linear-gradient(to bottom, #0b0b2b, #1b2735 70%, #090a0f); /* Dark gradient for stars */
        }

        .stars {
            width: 1px;
            height: 1px;
            position: absolute;
            background: white;
            box-shadow: 2vw 5vh 2px white, 10vw 8vh 2px white, 15vw 15vh 1px white,
                22vw 22vh 1px white, 28vw 12vh 2px white, 32vw 32vh 1px white,
                38vw 18vh 2px white, 42vw 35vh 1px white, 48vw 25vh 2px white,
                53vw 42vh 1px white, 58vw 15vh 2px white, 63vw 38vh 1px white,
                68vw 28vh 2px white, 73vw 45vh 1px white, 78vw 32vh 2px white,
                83vw 48vh 1px white, 88vw 20vh 2px white, 93vw 52vh 1px white,
                98vw 35vh 2px white, 5vw 60vh 1px white, 12vw 65vh 2px white,
                18vw 72vh 1px white, 25vw 78vh 2px white, 30vw 85vh 1px white,
                35vw 68vh 2px white, 40vw 82vh 1px white, 45vw 92vh 2px white,
                50vw 75vh 1px white, 55vw 88vh 2px white, 60vw 95vh 1px white,
                65vw 72vh 2px white, 70vw 85vh 1px white, 75vw 78vh 2px white,
                80vw 92vh 1px white, 85vw 82vh 2px white, 90vw 88vh 1px white,
                95vw 75vh 2px white;
            animation: twinkle 8s infinite linear;
        }

        .shooting-star {
            position: absolute;
            width: 100px;
            height: 2px;
            background: linear-gradient(90deg, white, transparent);
            animation: shoot 3s infinite ease-in;
            z-index: 2; /* Ensure shooting stars are above regular stars */
        }

        .shooting-star:nth-child(1) {
            top: 20%;
            left: -100px;
            animation-delay: 0s;
        }

        .shooting-star:nth-child(2) {
            top: 35%;
            left: -100px;
            animation-delay: 1s;
        }

        .shooting-star:nth-child(3) {
            top: 50%;
            left: -100px;
            animation-delay: 2s;
        }

        @keyframes twinkle {
            0%,
            100% {
                opacity: 0.8;
            }
            50% {
                opacity: 0.4;
            }
        }

        @keyframes shoot {
            0% {
                transform: translateX(0) translateY(0) rotate(25deg);
                opacity: 1;
            }
            100% {
                transform: translateX(120vw) translateY(50vh) rotate(25deg);
                opacity: 0;
            }
        }

        /* Additional twinkling stars with different animation timing */
        .stars::after {
            content: "";
            position: absolute;
            width: 1px;
            height: 1px;
            background: white;
            box-shadow: 8vw 12vh 2px white, 16vw 18vh 1px white, 24vw 25vh 2px white,
                33vw 15vh 1px white, 41vw 28vh 2px white, 49vw 35vh 1px white,
                57vw 22vh 2px white, 65vw 42vh 1px white, 73vw 28vh 2px white,
                81vw 48vh 1px white, 89vw 32vh 2px white, 97vw 45vh 1px white,
                3vw 68vh 2px white, 11vw 75vh 1px white, 19vw 82vh 2px white,
                27vw 88vh 1px white, 35vw 72vh 2px white, 43vw 85vh 1px white,
                51vw 92vh 2px white, 59vw 78vh 1px white;
            animation: twinkle 6s infinite linear reverse;
        }

        /* Existing Animations for text and image */
        @keyframes fade-in-down {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse-light {
            0%, 100% { box-shadow: 0 0 0 0px rgba(129, 140, 248, 0.7); }
            50% { box-shadow: 0 0 0 10px rgba(129, 140, 248, 0); }
        }

        /* Apply animations to elements */
        .animate-fade-in-down { animation: fade-in-down 1s ease-out forwards; }
        .animate-fade-in-up { animation: fade-in-up 1s ease-out forwards; }
        .animate-pulse-light { animation: pulse-light 2s infinite; }

        /* Custom CSS for multi-line text truncation with ellipsis */
        .blog-content-preview {
            overflow: hidden;
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-line-clamp: 5; /* Limit to 5 lines */
            text-overflow: ellipsis; /* Ensures ellipsis appears */
        }
    </style>
</head>
<body>

    <!-- Header Section -->
    <header class="bg-white shadow-md p-4 sticky top-0 z-50 rounded-b-lg">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center">
            <!-- Logo/Site Title -->
            <a href="#" class="text-3xl font-bold text-indigo-700 hover:text-indigo-900 transition duration-300">
                Siam's Insight
            </a>

            <!-- Navigation Menu -->
            <nav class="mt-4 md:mt-0">
                <ul class="flex flex-wrap justify-center space-x-4 md:space-x-8">
                    <li><a href="#home" class="text-gray-700 hover:text-indigo-600 font-medium transition duration-300 p-2 rounded-md">Home</a></li>
                    <li><a href="#blog" class="text-gray-700 hover:text-indigo-600 font-medium transition duration-300 p-2 rounded-md">Blog</a></li>
                    <li><a href="#premium-notes" class="text-gray-700 hover:text-indigo-600 font-medium transition duration-300 p-2 rounded-md">Premium Notes</a></li>
                    <li><a href="#about" class="text-gray-700 hover:text-indigo-600 font-medium transition duration-300 p-2 rounded-md">About</a></li>
                    <li><a href="#newsletter" class="text-gray-700 hover:text-indigo-600 font-medium transition duration-300 p-2 rounded-md">Newsletter</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Hero Section - Enhanced for Professional Appeal with Starry Background -->
    <section id="home" class="relative py-24 px-4 text-center rounded-lg m-4 shadow-2xl overflow-hidden">
        <!-- Stars Container -->
        <div class="hero-stars-container">
            <div class="stars"></div>
            <div class="shooting-star"></div>
            <div class="shooting-star"></div>
        </div>

        <div class="container mx-auto relative z-10"> <!-- Ensures content is above stars -->
            <!-- Frosted Glass Text Container -->
            <div class="bg-white/10 p-8 md:p-12 rounded-lg shadow-xl backdrop-filter backdrop-blur-sm mx-auto max-w-5xl mb-12">
                <h1 class="text-4xl md:text-5xl font-extrabold leading-tight mb-4 animate-fade-in-down text-gray-100">
                    Welcome to my space â€” where ideas in public health, education, research, and technology come together.
                </h1>
                <p class="text-xl md:text-2xl font-light mb-8 max-w-4xl mx-auto opacity-90 animate-fade-in-up text-gray-100 leading-relaxed">
                    Curated by **Shifat Shahriar Siam**, an undergraduate student of Public Health at Jahangirnagar University, this platform is dedicated to sharing thoughtful perspectives, timely insights, and meaningful explorations that aim to inform, inspire, and engage.
                </p>
            </div>
            <a href="#blog" class="inline-block bg-white text-indigo-800 hover:bg-gray-100 px-10 py-5 rounded-full text-xl font-bold shadow-xl transform hover:scale-105 transition duration-300 ease-in-out">
                Explore My Blog
            </a>
        </div>
    </section>

    <!-- Blog Section -->
    <section id="blog" class="py-16 px-4 bg-white m-4 rounded-lg shadow-xl">
        <div class="container mx-auto">
            <h2 class="text-4xl font-bold text-center text-gray-800 mb-12">Latest Blog Posts</h2>
            <div id="blogPostsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Blog posts will be loaded here dynamically by JavaScript -->
                <p class="text-gray-600 text-center col-span-full">Loading blog posts...</p>
            </div>
            <div class="text-center mt-12">
                <!-- This button could link to a dedicated "All Blogs" page if you had one,
                     for now, it refreshes or scrolls to the blog section. -->
                <a href="#blog" class="inline-block bg-indigo-600 text-white hover:bg-indigo-700 px-8 py-4 rounded-full text-lg font-semibold shadow-lg transform hover:scale-105 transition duration-300 ease-in-out">
                    View All Posts
                </a>
            </div>
        </div>
    </section>

    <!-- Premium Notes Section -->
    <section id="premium-notes" class="py-16 px-4 bg-gray-50 m-4 rounded-lg shadow-xl">
        <div class="container mx-auto">
            <h2 class="text-4xl font-bold text-center text-gray-800 mb-12">Premium Documents & Notes</h2>
            <p class="text-center text-gray-700 mb-10 max-w-2xl mx-auto">
                Access exclusive class notes, research guides, and in-depth analyses on public health, education, and various academic topics.
            </p>

            <div id="premiumDocumentsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Premium Documents will be loaded here dynamically by JavaScript -->
                <p class="text-gray-600 text-center col-span-full">Loading premium documents...</p>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-16 px-4 bg-white m-4 rounded-lg shadow-xl">
        <div class="container mx-auto flex flex-col md:flex-row items-center justify-center gap-12">
            <div class="w-full md:w-1/3 flex justify-center">
                <img src="https://i.postimg.cc/3NjnNC0N/IMG-20250112-145354-650.webp" alt="Shifat Shahriar Siam" class="rounded-full shadow-lg border-4 border-indigo-200 animate-pulse-light">
            </div>
            <div class="w-full md:w-2/3 text-center md:text-left">
                <h2 class="text-4xl font-bold text-gray-800 mb-6">About Shifat Shahriar Siam</h2>
                <p class="text-lg text-gray-700 mb-4 leading-relaxed">
                    I am Shifat Shahriar Siam, an undergraduate student majoring in Public Health at Jahangirnagar University, Savar, Dhaka. My academic journey is fueled by a passion for understanding and addressing health challenges within communities.
                </p>
                <p class="text-lg text-gray-700 mb-4 leading-relaxed">
                    Through "Siam's Insight," I aim to share my perspectives, research findings, and educational content on a diverse range of topics including public health, the intricacies of higher education, advancements in research, and the latest trends in technology. My goal is to create a platform for learning, discussion, and resource sharing.
                </p>
                <p class="text-lg text-gray-700 leading-relaxed">
                    Whether you're a fellow student, a public health professional, or just someone curious about these fields, I invite you to explore my thoughts and resources.
                </p>
                <!-- Removed social media links from About section -->
            </div>
        </div>
    </section>

    <!-- NEWSLETTER SECTION -->
    <section id="newsletter" class="bg-slate-800 rounded-xl p-12 text-center my-24 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]">
        <div class="bg-slate-800/80 backdrop-blur-sm p-8 rounded-lg">
            <h2 class="text-4xl font-bold text-white mb-3">Join the Newsletter</h2>
            <p class="text-slate-300 mb-8 max-w-xl mx-auto">Get my latest articles, new notes, and insights delivered directly to your inbox. No spam, ever. Sincerely ss.siam</p>
            <form id="newsletter-form" class="flex flex-col md:flex-row justify-center items-center gap-4 max-w-lg mx-auto">
                <input id="newsletter-email" type="email" placeholder="your.email@example.com" class="w-full md:w-2/3 p-4 rounded-lg border-0 text-slate-800 focus:outline-none focus:ring-4 focus:ring-emerald-500/50" required>
                <button id="newsletter-button" type="submit" class="bg-emerald-500 text-white font-bold py-4 px-8 rounded-lg w-full md:w-auto hover:bg-emerald-600 transition shadow-lg">Subscribe</button>
            </form>
            <p id="newsletter-message" class="text-sm h-4 mt-4 text-emerald-300"></p>
        </div>
    </section>

    <!-- FOOTER SECTION - Redesigned -->
    <footer class="bg-slate-900 text-slate-400">
        <div class="container mx-auto px-6 pt-16 pb-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <!-- About Column -->
                <div class="col-span-1 md:col-span-2 text-center md:text-left">
                    <h4 class="text-2xl font-bold text-white mb-4">Shifat Shahriar Siam</h4>
                    <p class="text-sm leading-relaxed">
                        A personal platform for sharing knowledge and resources in Public Health and Informatics. Committed to exploring data-driven solutions for a healthier future.
                    </p>
                </div>
                <!-- Contact Info Column -->
                <div class="text-center md:text-left">
                    <h4 class="text-xl font-bold text-white mb-4">Contact Info</h4>
                    <ul class="space-y-3 text-sm">
                        <li class="flex items-start justify-center md:justify-start">
                            <i class="fas fa-map-marker-alt w-4 mr-2 mt-1 text-slate-400"></i>
                            <span>21 no Hall, Jahangirnagar University, Savar-1342, Dhaka</span>
                        </li>
                        <li class="flex items-start justify-center md:justify-start">
                            <i class="fas fa-envelope w-4 mr-2 mt-1 text-slate-400"></i>
                            <a href="mailto:20212954156siam@juniv.edu" class="hover:text-emerald-400 transition-colors">20212954156siam@juniv.edu</a>
                        </li>
                    </ul>
                </div>
                <!-- Follow Me Column -->
                <div class="text-center md:text-left">
                    <h4 class="text-xl font-bold text-white mb-4">Follow Me</h4>
                    <div class="flex justify-center md:justify-start space-x-5 text-2xl">
                        <a href="https://www.facebook.com/shifat.shahriar.siam.2002" target="_blank" rel="noopener noreferrer" aria-label="Facebook" class="text-slate-400 hover:text-emerald-400 transition-colors">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://x.com/realDonaldTrump" target="_blank" rel="noopener noreferrer" aria-label="Twitter" class="text-slate-400 hover:text-emerald-400 transition-colors">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://www.youtube.com/@aparadisebird" target="_blank" rel="noopener noreferrer" aria-label="YouTube" class="text-slate-400 hover:text-emerald-400 transition-colors">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="https://www.instagram.com/ss_siam07/" target="_blank" rel="noopener noreferrer" aria-label="Instagram" class="text-slate-400 hover:text-emerald-400 transition-colors">
                            <i class="fab fa-instagram"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="mt-12 border-t border-slate-800 pt-6 text-center text-sm">
                <p>&copy; 2025 Shifat Shahriar Siam. All Rights Reserved.</p>
            </div>
        </div>
    </footer>
    <!-- Modals for Bkash Payment and Ad Watching (Remains the same) -->
    <div id="bkashModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden">
        <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md">
            <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">Purchase <span id="bkashDocTitle" class="text-indigo-600"></span> via Bkash</h3>
            <p class="text-gray-700 mb-4">
                Please send the exact amount to my Bkash Personal Number: <strong class="text-green-700">01XXXXXXXXX</strong>.
            </p>
            <p class="text-gray-700 mb-6">
                After sending money, please submit the Transaction ID (TrxID) below. I will verify it manually and send the document link to your email.
            </p>
            <div class="mb-4">
                <label for="buyerNameBkash" class="block text-gray-700 text-sm font-bold mb-2 text-left">Your Full Name</label>
                <input type="text" id="buyerNameBkash" class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 rounded-md" placeholder="Your Name">
            </div>
            <div class="mb-4">
                <label for="buyerEmailBkash" class="block text-gray-700 text-sm font-bold mb-2 text-left">Your Email Address</label>
                <input type="email" id="buyerEmailBkash" class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 rounded-md" placeholder="john.doe@example.com">
            </div>
            <div class="mb-6">
                <label for="trxId" class="block text-gray-700 text-sm font-bold mb-2 text-left">Bkash Transaction ID (TrxID)</label>
                <input type="text" id="trxId" class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 rounded-md" placeholder="ABC123XYZ789">
            </div>
            <div class="flex justify-end space-x-4">
                <button onclick="closeModal('bkashModal')" class="bg-gray-300 text-gray-800 hover:bg-gray-400 px-6 py-3 rounded-lg font-semibold transition duration-300">
                    Cancel
                </button>
                <button onclick="submitBkashOrder()" class="bg-indigo-600 text-white hover:bg-indigo-700 px-6 py-3 rounded-lg font-semibold transition duration-300">
                    Submit Order
                </button>
            </div>
        </div>
    </div>

    <div id="adModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden">
        <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md">
            <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">Watch Ad to Access <span id="adDocTitle" class="text-indigo-600"></span></h3>
            <div id="adContainer" class="bg-gray-200 h-48 flex items-center justify-center text-gray-600 text-center rounded-md mb-6">
                <!-- AdSense Ad Unit will be dynamically placed here by JavaScript -->
                <p>Loading advertisement...</p>
            </div>
            <p class="text-gray-700 mb-6 text-center">
                Please watch the entire advertisement to unlock your document.
            </p>
            <div class="flex justify-end space-x-4">
                <button onclick="closeModal('adModal')" class="bg-gray-300 text-gray-800 hover:bg-gray-400 px-6 py-3 rounded-lg font-semibold transition duration-300">
                    Cancel
                </button>
                <button id="accessDocButton" onclick="accessDocumentAfterAd()" class="bg-green-600 text-white hover:bg-green-700 px-6 py-3 rounded-lg font-semibold transition duration-300 hidden">
                    Access Document
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript for Modal Functionality and Firebase Integration -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>

    <script>
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCGY3j4yIpHMkc4DOcFBhzs2hfEVsw0VJ0",
            authDomain: "siamwebsite2022.firebaseapp.com",
            projectId: "siamwebsite2022",
            storageBucket: "siamwebsite2022.firebasestorage.app",
            messagingSenderId: "964747721403",
            appId: "1:964747721403:web:1860b8c0533bcf6d6cc79e"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = app.firestore();
        const auth = app.auth();
        const storage = app.storage();

        // --- Functions for Frontend Dynamic Content ---
        const blogPostsGrid = document.getElementById('blogPostsGrid');
        const premiumDocumentsGrid = document.getElementById('premiumDocumentsGrid');

        // Function to truncate HTML content
        function truncateHtml(html, maxLength) {
            if (!html) return '';

            // Create a temporary div to parse the HTML and get plain text
            const div = document.createElement('div');
            div.innerHTML = html;
            let text = div.textContent || div.innerText || '';

            if (text.length <= maxLength) {
                return html; // Return full HTML if it's already short enough
            }

            let truncatedText = text.substring(0, maxLength);

            // Find the last complete word to avoid cutting words in half
            const lastSpace = truncatedText.lastIndexOf(' ');
            if (lastSpace > -1) {
                truncatedText = truncatedText.substring(0, lastSpace);
            }

            return truncatedText + '...'; // Add ellipsis
        }

        // Increment Like count for a blog post
        async function incrementLike(postId) {
            try {
                const postRef = db.collection('blogPosts').doc(postId);
                await postRef.update({
                    likes: firebase.firestore.FieldValue.increment(1)
                });
                console.log(`Liked post ${postId}`);
                // No need to reload specific card if real-time listener is active on blogPostsGrid (but it's not currently, only on admin)
                // For live update on homepage, you would need to implement an onSnapshot listener here for 'blogPosts'
            } catch (error) {
                console.error("Error liking post:", error);
            }
        }

        // Increment Dislike count for a blog post
        async function incrementDislike(postId) {
            try {
                const postRef = db.collection('blogPosts').doc(postId);
                await postRef.update({
                    dislikes: firebase.firestore.FieldValue.increment(1)
                });
                console.log(`Disliked post ${postId}`);
            } catch (error) {
                console.error("Error disliking post:", error);
            }
        }

        // Load Blog Posts from Firestore
        async function loadBlogPosts() {
            blogPostsGrid.innerHTML = '<p class="text-gray-600 text-center col-span-full">Loading blog posts...</p>';
            try {
                const snapshot = await db.collection('blogPosts').orderBy('date', 'desc').get();
                blogPostsGrid.innerHTML = '';

                if (snapshot.empty) {
                    blogPostsGrid.innerHTML = '<p class="text-gray-600 text-center col-span-full">No blog posts published yet.</p>';
                    return;
                }

                snapshot.forEach(doc => {
                    const post = doc.data();
                    const postId = doc.id; // Get the document ID for interaction
                    const postDate = new Date(post.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                    
                    const truncatedContent = truncateHtml(post.content, 200); // Adjust 200 for desired preview length

                    const postElement = `
                        <article class="bg-gray-50 rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 overflow-hidden">
                            <img src="${post.imageUrl || 'https://placehold.co/600x400/9ca3af/ffffff?text=Blog+Image'}" alt="${post.title}" class="w-full h-48 object-cover rounded-t-lg" onerror="this.onerror=null;this.src='https://placehold.co/600x400/9ca3af/ffffff?text=Image+Missing';">
                            <div class="p-6">
                                <a href="blog-post-detail.html?slug=${post.slug}" class="block">
                                    <h3 class="text-2xl font-semibold text-gray-900 mb-3 hover:text-indigo-700 transition duration-300">${post.title}</h3>
                                </a>
                                <p class="text-gray-700 mb-4">${truncatedContent}</p>
                                <div class="flex justify-between items-center text-sm text-gray-500 mb-4">
                                    <span>By <a href="index.html#about" class="text-indigo-600 hover:underline">${post.author}</a></span>
                                    <span>${postDate}</span>
                                </div>
                                <a href="blog-post-detail.html?slug=${post.slug}" class="text-indigo-600 hover:text-indigo-800 font-semibold flex items-center mb-4">
                                    Read More
                                    <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                                </a>
                                <!-- Like, Dislike, Views Buttons -->
                                <div class="flex items-center justify-between text-sm text-gray-600 mt-4 pt-4 border-t border-gray-200">
                                    <div class="flex items-center space-x-3">
                                        <button onclick="incrementLike('${postId}')" class="flex items-center text-green-600 hover:text-green-700 transition duration-200">
                                            <svg class="w-5 h-5 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-thumbs-up"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path></svg>
                                            <span>${post.likes || 0}</span>
                                        </button>
                                        <button onclick="incrementDislike('${postId}')" class="flex items-center text-red-600 hover:text-red-700 transition duration-200">
                                            <svg class="w-5 h-5 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-thumbs-down"><path d="M10 15V19a3 3 0 0 0 3 3l4-9V3H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zM17 2H20a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2h-3"></path></svg>
                                            <span>${post.dislikes || 0}</span>
                                        </button>
                                    </div>
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-1 text-gray-500" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
                                        <span>${post.views || 0} Views</span>
                                    </div>
                                </div>
                            </div>
                        </article>
                    `;
                    blogPostsGrid.innerHTML += postElement;
                });
            } catch (error) {
                console.error("Error loading blog posts:", error);
                blogPostsGrid.innerHTML = '<p class="text-red-500 text-center col-span-full">Error loading blog posts. Please try again later.</p>';
            }
        }

        // Load Premium Documents (Remains the same as previous update)
        async function loadPremiumDocuments() {
            premiumDocumentsGrid.innerHTML = '<p class="text-gray-600 text-center col-span-full">Loading premium documents...</p>';
            try {
                const snapshot = await db.collection('premiumDocuments').get();
                premiumDocumentsGrid.innerHTML = '';

                if (snapshot.empty) {
                    premiumDocumentsGrid.innerHTML = '<p class="text-gray-600 text-center col-span-full">No premium documents available yet.</p>';
                    return;
                }

                snapshot.forEach(doc => {
                    const document = doc.data();
                    let buttonsHtml = '';

                    const allowBkash = !!document.allowBkash;
                    const allowAd = !!document.allowAd;

                    if (allowBkash) {
                        buttonsHtml += `
                            <button onclick="showBkashPaymentModal('${document.name}')" class="w-full bg-indigo-600 text-white hover:bg-indigo-700 px-6 py-3 rounded-lg font-semibold shadow-lg transform hover:scale-105 transition duration-300 ease-in-out mb-2">
                                Buy via Bkash
                            </button>
                        `;
                    }
                    if (allowAd) {
                        buttonsHtml += `
                            <button onclick="showAdModal('${document.name}')" class="w-full bg-yellow-500 text-gray-900 hover:bg-yellow-600 px-6 py-3 rounded-lg font-semibold shadow-md transform hover:scale-105 transition duration-300 ease-in-out">
                                Watch Ad to Access (Free)
                            </button>
                        `;
                    }
                    if (!allowBkash && !allowAd) {
                        buttonsHtml = '<p class="text-gray-500 text-center text-sm">Access options not available for this document.</p>';
                    }


                    const docElement = `
                        <div class="bg-white rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 overflow-hidden">
                            <img src="${document.previewImageUrl || 'https://placehold.co/600x400/d1d5db/4b5563?text=Document+Preview'}" alt="${document.name}" class="w-full h-48 object-cover rounded-t-lg" onerror="this.onerror=null;this.src='https://placehold.co/600x400/d1d5db/4b5563?text=Image+Missing';">
                            <div class="p-6">
                                <h3 class="text-2xl font-semibold text-gray-900 mb-3">${document.name}</h3>
                                <p class="text-gray-700 mb-4 line-clamp-3">${document.description}</p>
                                <div class="flex items-center justify-between mb-6">
                                    <span class="text-3xl font-bold text-green-700">BDT ${document.priceBDT || 'N/A'}</span>
                                    <span class="text-sm text-gray-500 italic">${document.pages || 'N/A'} pages</span>
                                </div>
                                <div class="flex flex-col space-y-3">
                                    ${buttonsHtml}
                                </div>
                            </div>
                        </div>
                    `;
                    premiumDocumentsGrid.innerHTML += docElement;
                });
            } catch (error) {
                console.error("Error loading premium documents:", error);
                premiumDocumentsGrid.innerHTML = '<p class="text-red-500 text-center col-span-full">Error loading premium documents. Please try again later.</p>';
            }
        }


        // Run functions to load data when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            loadBlogPosts();
            loadPremiumDocuments();
            // Attach newsletter form listener
            const newsletterForm = document.getElementById('newsletter-form');
            if (newsletterForm) {
                newsletterForm.addEventListener('submit', subscribeToNewsletter);
            }
        });

        // Newsletter Subscription Function
        async function subscribeToNewsletter(event) {
            event.preventDefault(); // Prevent default form submission and page reload
            const emailInput = document.getElementById('newsletter-email');
            const messageElement = document.getElementById('newsletter-message');
            const email = emailInput.value.trim();

            messageElement.textContent = 'Subscribing...';
            messageElement.classList.remove('text-red-300', 'text-emerald-300'); // Clear previous colors
            messageElement.classList.add('text-slate-300');

            if (!email) {
                messageElement.textContent = 'Please enter your email address.';
                messageElement.classList.add('text-red-300');
                return;
            }

            try {
                // Check if email already exists
                const existingSubscriber = await db.collection('newsletterSubscribers').doc(email).get();
                if (existingSubscriber.exists) {
                    messageElement.textContent = 'Email already subscribed! Thank you for your continued support!';
                    messageElement.classList.add('text-emerald-300');
                    return;
                }

                // Sign in anonymously if not already authenticated (to satisfy Firestore rules)
                await auth.signInAnonymously();

                // Save email to Firestore using email as document ID
                await db.collection('newsletterSubscribers').doc(email).set({
                    email: email,
                    subscribedAt: new Date().toISOString()
                });

                emailInput.value = ''; // Clear the input field
                messageElement.textContent = 'Thank you for subscribing! I will keep you updated with the latest insights. Sincerely, Shifat Shahriar Siam';
                messageElement.classList.remove('text-slate-300');
                messageElement.classList.add('text-emerald-300');
            } catch (error) {
                console.error("Error subscribing to newsletter:", error);
                messageElement.textContent = `Subscription failed: ${error.message}. Please try again.`;
                messageElement.classList.remove('text-slate-300');
                messageElement.classList.add('text-red-300');
            }
        }

        // Function to show a modal (remains same)
        function showModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
        }

        // Function to close a modal (remains same)
        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        // Show Bkash payment modal (remains same)
        function showBkashPaymentModal(docTitle) {
            document.getElementById('bkashDocTitle').textContent = docTitle;
            showModal('bkashModal');
        }

        // Function to submit Bkash order to Firestore (remains same)
        async function submitBkashOrder() {
            const docTitle = document.getElementById('bkashDocTitle').textContent;
            const buyerName = document.getElementById('buyerNameBkash').value;
            const buyerEmail = document.getElementById('buyerEmailBkash').value;
            const trxId = document.getElementById('trxId').value;

            if (!buyerName || !buyerEmail || !trxId) {
                alert('Please fill in all fields.');
                return;
            }

            let userId = null;
            try {
                const userCredential = await auth.signInAnonymously();
                userId = userCredential.user.uid;
                console.log("Signed in anonymously with UID:", userId);
            } catch (error) {
                console.error("Authentication error during order:", error);
                alert("Authentication error during order. Please try again. (Check console for details)");
                return;
            }

            let documentData = null;
            let documentFirestoreId = null;
            try {
                const docSnapshot = await db.collection('premiumDocuments').where('name', '==', docTitle).limit(1).get();
                if (!docSnapshot.empty) {
                    documentData = docSnapshot.docs[0].data();
                    documentFirestoreId = docSnapshot.docs[0].id;
                } else {
                    alert('Error: Document details not found for purchase. Please contact support.');
                    console.error('Premium document not found in Firestore for title:', docTitle);
                    return;
                }
            } catch (error) {
                console.error("Error fetching document details for order:", error);
                alert("Error fetching document details for purchase. Please try again. (Check console for details)");
                return;
            }

            try {
                await db.collection('bkashOrders').add({
                    documentName: docTitle,
                    buyerName: buyerName,
                    buyerEmail: buyerEmail,
                    bkashTrxId: trxId,
                    orderDate: new Date().toISOString(),
                    status: 'pending',
                    userId: userId,
                    documentFirestoreId: documentFirestoreId,
                    documentUrl: documentData.externalDownloadUrl || ''
                });
                alert('Your order has been submitted successfully! You will receive an email upon verification. Thank you!');
                closeModal('bkashModal');
                document.getElementById('buyerNameBkash').value = '';
                document.getElementById('buyerEmailBkash').value = '';
                document.getElementById('trxId').value = '';
            } catch (error) {
                console.error("Error adding order document to Firestore:", error);
                alert("There was an error submitting your order. Please try again. (Check console for details)");
            }
        }

        // Show Ad modal (remains same, with AdSense integration)
        function showAdModal(docTitle) {
            document.getElementById('adDocTitle').textContent = docTitle;
            document.getElementById('accessDocButton').classList.add('hidden');
            document.getElementById('adContainer').innerHTML = '<p class="text-center text-gray-600">Loading advertisement...</p>';

            showModal('adModal');

            const adUnitHtml = `
                <ins class="adsbygoogle"
                     style="display:block; text-align:center; min-height: 100px; min-width: 100px;"
                     data-ad-client="ca-pub-6894065582382364"
                     data-ad-slot="1570571656"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
            `;
            document.getElementById('adContainer').innerHTML = adUnitHtml;

            if (window.adsbygoogle && window.adsbygoogle.push) {
                (window.adsbygoogle = window.adsbygoogle || []).push({});
            } else {
                console.warn("AdSense script not loaded or not ready. Ad might not display.");
            }

            setTimeout(() => {
                document.getElementById('adContainer').innerHTML = `
                    <div class="flex flex-col items-center justify-center p-4">
                        <svg class="w-16 h-16 text-green-500 mb-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        <p class="text-green-700 font-bold text-lg">Ad watched successfully!</p>
                        <p class="text-gray-500 text-sm mt-1">Access button will appear shortly.</p>
                    </div>
                `;
                document.getElementById('accessDocButton').classList.remove('hidden');
            }, 3000);
        }

        // Simulate document access after ad (remains same)
        async function accessDocumentAfterAd() {
            const docTitle = document.getElementById('adDocTitle').textContent;
            let documentData = null;
            try {
                const docSnapshot = await db.collection('premiumDocuments').where('name', '==', docTitle).limit(1).get();
                if (!docSnapshot.empty) {
                    documentData = docSnapshot.docs[0].data();
                    const downloadUrl = documentData.externalDownloadUrl;
                    if (downloadUrl) {
                        alert(`Document "${docTitle}" is now accessible! Opening download link.`);
                        window.open(downloadUrl, '_blank');
                    } else {
                        alert(`Document "${docTitle}" is accessible, but no download link found. Please contact support.`);
                        console.error(`Download URL missing for document: ${docTitle}`);
                    }
                } else {
                    alert('Error: Premium document details not found for ad access. Please contact support.');
                    console.error('Premium document not found in Firestore for ad access for title:', docTitle);
                }
            } catch (error) {
                console.error("Error fetching document for ad access:", error);
                alert("Error accessing document after ad. Please try again. (Check console for details)");
            }
            closeModal('adModal');
        }

        // Smooth scrolling for navigation links (remains same)
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();

                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    </script>
</body>
</html>
